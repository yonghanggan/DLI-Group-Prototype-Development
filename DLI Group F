from google.colab import drive
drive.mount('/content/drive')


!unzip "/content/drive/MyDrive/CICIDS2017_Data/MachineLearningCSV.zip" -d "/content/cicids2017"


import os

folder_path = "/content/cicids2017/MachineLearningCVE"
for file in os.listdir(folder_path):
    print(file)


import pandas as pd

# Use the correct full path and exact filename
df = pd.read_csv('/content/cicids2017/MachineLearningCVE/Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv')

# Show dataset shape and first few rows
print("Shape:", df.shape)
df.head()


# List all columns and their data types
df.info()


import pandas as pd
from sklearn.preprocessing import StandardScaler

# 1. Strip extra spaces from column names
df.columns = df.columns.str.strip()

# 2. Convert all numeric fields (already done via pandas)
# (no need to drop extra columns)

# 3. Handle missing values (drop rows with NaN or Inf)
df = df.replace([float('inf'), float('-inf')], pd.NA)
df = df.dropna()

# 4. Encode 'Label' column: BENIGN = 0, attack = 1
df['Label'] = df['Label'].apply(lambda x: 0 if x == 'BENIGN' else 1)

# 5. Split features and labels
X = df.drop('Label', axis=1)
y = df['Label']

# 6. Normalize the features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

print("âœ… Data cleaned and normalized.")


from sklearn.model_selection import train_test_split

# Split into training and testing sets (80% train, 20% test)
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42, stratify=y
)

print("Train size:", X_train.shape[0])
print("Test size:", X_test.shape[0])


# Import TensorFlow and necessary Keras components
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Dropout
